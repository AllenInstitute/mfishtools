<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filter genes for spatial transcriptomics panel — filterPanelGenes • mfishtools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filter genes for spatial transcriptomics panel — filterPanelGenes"><meta property="og:description" content="Returns a set of genes for inclusion in a spatial transcriptomics panel based on a series of
  hard-coded and user-defined constraints"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mfishtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/inhibitory_marker_mapping.html">Mapping mFISH data to reference data set</a>
    </li>
    <li>
      <a href="../articles/inhibitory_marker_selection.html">Marker panel generation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter genes for spatial transcriptomics panel</h1>

    <div class="hidden name"><code>filterPanelGenes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns a set of genes for inclusion in a spatial transcriptomics panel based on a series of
  hard-coded and user-defined constraints</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filterPanelGenes</span><span class="op">(</span></span>
<span>  <span class="va">summaryExpr</span>,</span>
<span>  propExpr <span class="op">=</span> <span class="va">summaryExpr</span>,</span>
<span>  onClusters <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">summaryExpr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  offClusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geneLengths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  startingGenes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GAD1"</span>, <span class="st">"SLC17A7"</span><span class="op">)</span>,</span>
<span>  numBinaryGenes <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  minOn <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxOn <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  maxOff <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  minLength <span class="op">=</span> <span class="fl">960</span>,</span>
<span>  fractionOnClusters <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  onThreshold <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  excludeGenes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  excludeFamilies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LOC"</span>, <span class="st">"LINC"</span>, <span class="st">"FAM"</span>, <span class="st">"ORF"</span>, <span class="st">"KIAA"</span>, <span class="st">"FLJ"</span>, <span class="st">"DKFZ"</span>, <span class="st">"RIK"</span>, <span class="st">"RPS"</span>,</span>
<span>    <span class="st">"RPL"</span>, <span class="st">"\\-"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-summaryexpr">summaryExpr<a class="anchor" aria-label="anchor" href="#arg-summaryexpr"></a></dt>
<dd><p>Matrix of summarized expression levels for a given cluster.  Typically the median
or mean should be used.  Rows are genes and columns are samples.  ROW NAMES MUST BE GENE SYMBOLS!</p></dd>


<dt id="arg-propexpr">propExpr<a class="anchor" aria-label="anchor" href="#arg-propexpr"></a></dt>
<dd><p>Proportion of cells expressed in each cluster for use with binary score calculation
(default = summaryExpr, which is not recommended)</p></dd>


<dt id="arg-onclusters">onClusters<a class="anchor" aria-label="anchor" href="#arg-onclusters"></a></dt>
<dd><p>Vector indicating which clusters should be included in the gene panel (default
is all clusters. Can be logical or numeric, or a character string of cluster names)</p></dd>


<dt id="arg-offclusters">offClusters<a class="anchor" aria-label="anchor" href="#arg-offclusters"></a></dt>
<dd><p>Vector indidicating from which clusters expression should be avoided</p></dd>


<dt id="arg-numbinarygenes">numBinaryGenes<a class="anchor" aria-label="anchor" href="#arg-numbinarygenes"></a></dt>
<dd><p>Number of genes to include in the final panel.  Genes are sorted by binary
score using `getBetaScore` and this number of genes are chosen (default = 500)</p></dd>


<dt id="arg-minon">minOn<a class="anchor" aria-label="anchor" href="#arg-minon"></a></dt>
<dd><p>Minimum summary expression level in most highly expressed "on" cluster (default = 10)</p></dd>


<dt id="arg-maxon">maxOn<a class="anchor" aria-label="anchor" href="#arg-maxon"></a></dt>
<dd><p>Maximum summary expression level in most highly expressed "on" cluster (default = 250)</p></dd>


<dt id="arg-maxoff">maxOff<a class="anchor" aria-label="anchor" href="#arg-maxoff"></a></dt>
<dd><p>Maximum summary expression level in most highly expressed "off" cluster (default = 50)</p></dd>


<dt id="arg-minlength">minLength<a class="anchor" aria-label="anchor" href="#arg-minlength"></a></dt>
<dd><p>Minimum gene length for marker gene selection.  Ignored if geneLength is not
provided (default = 960)</p></dd>


<dt id="arg-fractiononclusters">fractionOnClusters<a class="anchor" aria-label="anchor" href="#arg-fractiononclusters"></a></dt>
<dd><p>What is the maximum fraction of clusters in which a gene can be expressed
(as defined by propExpr&gt;onThreshold; default = 0.5).  This prevents nearly ubiquitous genes from selection</p></dd>


<dt id="arg-onthreshold">onThreshold<a class="anchor" aria-label="anchor" href="#arg-onthreshold"></a></dt>
<dd><p>What fraction of cells need to have expression for a gene to be defined as expressed
(default = 0.5)</p></dd>


<dt id="arg-excludegenes">excludeGenes<a class="anchor" aria-label="anchor" href="#arg-excludegenes"></a></dt>
<dd><p>Which genes should be excluded from the analysis (default is none)</p></dd>


<dt id="arg-excludefamilies">excludeFamilies<a class="anchor" aria-label="anchor" href="#arg-excludefamilies"></a></dt>
<dd><p>Which gene classes or families should be excluded from the analysis?  More
specifically, any gene that contain these strings of characters anywhere in the symbol will be
excluded (default is "LOC","LINC","FAM","ORF","KIAA","FLJ","DKFZ","RIK","RPS","RPL","\-").</p></dd>


<dt id="arg-genelength">geneLength<a class="anchor" aria-label="anchor" href="#arg-genelength"></a></dt>
<dd><p>Optional vector of gene lengths in same order as summaryExpr.  Default is NULL</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A character vector of genes meeting all constraints</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Miller.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

